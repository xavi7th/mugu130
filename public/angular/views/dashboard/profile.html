<div id="main-controller" style="background: #fff;">
  <ng-include src="'angular/views/partials/menu.html'"></ng-include>

  <user-profile></user-profile>

  <section id="stats">


    <div class="grid-container">
      <div class="grid-15 tablet-grid-15">
        <div id="profile-menu" class="ui compact vertical labeled icon menu">
          <a class="item active" data-tab="profile">
            <i class="user icon"></i>
            My Data
          </a>
          <a class="item" data-tab="statistics">
            <i class="area chart icon"></i>
            Statistics
          </a>
          <a class="item" data-tab="transactions">
            <i class="visa icon"></i>
            Transactions
          </a>
          <a class="item" data-tab="earnings">
            <i class="dollar icon"></i>
            Earnings
          </a>

        </div>
      </div>
      <div class="grid-85 tablet-grid-85">
        <div class="ui active tab" data-tab="profile">
          <div class="ui compact segment">
            <p>My Data</p>
          </div>
          <table class="ui blue celled table">

            <tbody>
              <tr>
                <td>E-mail</td>
                <td>{{ userdetails.email || 'N/A' }}</td>
              </tr>
              <tr>
                <td>Phone Number</td>
                <td>{{ userdetails.phone1 || 'N/A' }}</td>
              </tr>
              <tr>
                <td>Phone Network</td>
                <td>{{ userdetails.network || 'N/A' | uppercase }}</td>
              </tr>
              <tr>
                <td>Address</td>
                <td>{{ userdetails.address || 'N/A'  }}, {{ userdetails.town }}, {{ userdetails.state }}</td>
              </tr>
              <tr>
                <td>My bank</td>
                <td>{{ userdetails.bank || 'N/A'  }}</td>
              </tr>
              <tr>
                <td>Account Name</td>
                <td>{{ userdetails.firstname }} {{ userdetails.lastname }}</td>
              </tr>
              <tr>
                <td>Account Number</td>
                <td>{{ userdetails.acct_no || 'N/A'  }}</td>
              </tr>
              <tr>
                <td>Account Type</td>
                <td>{{ userdetails.acct_type || 'N/A'  }}</td>
              </tr>

            </tbody>
          </table>
        </div>
        <div class="ui tab " data-tab="statistics">
          <div class="ui compact segment">
            <p>Statistics</p>
          </div>
          <table class="ui blue celled table">
        
            <tbody>
              <tr>
                <td>No. of games played</td>
                <td>{{ _.size(user_games) }} ( {{ _.size(_.filter(user_games, ['payment_status', 'paid'])) * 35 | currency }} ) <span style="color:red">{{  _.size(_.filter(user_games, ['payment_status', 'nullified'])) }} games nullified</span></td>
              </tr>
              <tr>
                <td>Total earnings</td>
                <td>{{ _.sumBy(user_earnings, 'amount') | currency }}</td>
              </tr>
              <tr>
                <td>Untransferred earnings</td>
                <td>{{ _.sumBy(_.filter(user_earnings, ['transferred', false]), 'amount') | currency }}</td>
              </tr>
              <tr>
                <td>Transferred earnings</td>
                <td>{{ _.sumBy(_.filter(user_earnings, ['transferred', true]), 'amount') | currency }}</td>
              </tr>
              <tr>
                <td>Total amount withdrwan</td>
                <td>{{userdetails.total_withdrawals  | currency }}</td>
              </tr>
              <tr>
                <td>No. of withdrawal requests</td>
                <td>{{ userdetails.num_of_withdrawals  }}</td>
              </tr>
              <tr>
                <td>No. of referrals</td>
                <td>{{ referrals.length }}</td>
              </tr>
              <tr>
                <td>Total Referral Bonus</td>
                <td>{{ _.sumBy(_.filter(user_earnings, ['amount', 1]), 'amount') | currency }}</td>
              </tr>
              <tr ng-class="{'negative': userdetails.units_purchased < 0}">
                <td>Total wallet funding made</td>
                <!-- <td ng-if="userdetails.units_purchased > 0">{{ userdetails.units_purchased | currency }}</td>
                <td ng-if="userdetails.units_purchased < 0">₦ {{ userdetails.units_purchased }}.00</td> -->
                <td>{{ _.sumBy(_.filter(user_transactions, { 'status': 'completed', 'trans_type': 'wallet funding' }), 'amount') | currency }}</td>
              </tr>
              <tr ng-class="{'negative': userdetails.units_purchased < 0}">
                <td>Total no. of wallet funding</td>
                <td>{{ _.size(_.filter(user_transactions, { 'status': 'completed', 'trans_type': 'wallet funding' })) }}</td>
              </tr>

            </tbody>
          </table>
        </div>
        <div class="ui tab" data-tab="transactions">
          <div class="ui compact segment">
            <p>Transactions</p>
          </div>
          <table class="ui blue striped celled table">
            <thead>
              <tr>
                <th>S/N</th>
                <th>Date</th>
                <th>Type</th>
                <th>Amount</th>
                <th>Channel</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>

                <tr ng-repeat="transaction in user_transactions" ng-class="{'negative': transaction.trans_type == 'withdrawal' || transaction.amount < 0}">
                  <td>{{ $index + 1 }}</td>
                  <td>{{ transaction.created_at | timeAgo}}</td>
                  <td>{{ transaction.trans_type }}</td>
                  <td ng-if="transaction.amount > 0">{{ transaction.amount | currency }}</td>
                  <td ng-if="transaction.amount < 0">₦ {{ transaction.amount }}.00</td>
                  <td>{{ transaction.channel }}</td>
                  <td>{{ transaction.status }}</td>
                </tr>

            </tbody>
          </table>
        </div>
        <div class="ui tab" data-tab="earnings">
          <div class="ui compact segment">
            <p>Earnings</p>
          </div>
          <table class="ui blue celled table">
            <thead>
              <tr>
                <th>S/N</th>
                <th>Game ID</th>
                <th>Date</th>
                <th>Amount</th>
              </tr>
            </thead>
            <tbody>

                <tr ng-repeat="earning in user_earnings">
                  <td>{{ $index + 1 }}</td>
                  <td>
                    <span ng-if="earning.game_id">{{ earning.game_id }}</span>
                    <span ng-if="!earning.game_id"> Referral Bonus </span>
                  </td>
                  <td>{{ earning.created_at | timeAgo}}</td>
                  <td>{{ earning.amount | currency }}</td>
                </tr>

            </tbody>
          </table>
        </div>

      </div>
    </div>
  </section>


    <footer ng-include src="'angular/views/partials/footer.html'"></footer>

</div>
